# 🚢 港口出库管理 - 驳回和修改功能详细说明

## 📋 功能概述

已完善港口物资管理系统的出库管理功能，新增了驳回原因输入和出库修改功能，更符合港口管理的实际业务需求。

## 🔧 新增功能详解

### 1. 驳回功能优化

#### 📝 驳回原因输入
**触发条件：** 点击"驳回"按钮时
**功能特点：**
- 弹出专门的驳回原因输入框
- 显示出库单基本信息（单号、仓库、领用部门）
- 必须输入驳回原因（5-200字符）
- 提供驳回类别快速选择

#### 🏷️ 驳回类别标签
**预设类别：**
- **库存不足** - 仓库物资库存不够
- **信息错误** - 申请信息填写错误或不完整
- **流程不符** - 审批流程不符合港口管理规定
- **其他** - 其他特殊原因

#### ✅ 驳回流程
```
点击驳回 → 弹出驳回窗口 → 选择类别 → 输入详细原因 → 确认驳回 → 系统记录
```

### 2. 出库修改功能

#### 🎯 港口管理特色设计
**符合港口业务场景的设计：**

1. **仓库选择**
   - 码头1号仓库
   - 码头2号仓库  
   - 散货仓库
   - 支持港口多仓库管理

2. **出库类型**
   - **正常出库** - 日常物资领用
   - **紧急出库** - 设备故障紧急维修
   - **移库出库** - 仓库间物资调拨
   - **退库出库** - 多余物资退回

3. **领用类型**
   - **生产用** - 码头装卸作业
   - **维修用** - 设备维护保养
   - **办公用** - 日常办公需求
   - **其他** - 特殊用途

4. **部门设置**
   - 生产部 - 负责装卸作业
   - 维修部 - 设备维护
   - 装卸部 - 货物装卸

#### 📊 出库明细管理
**智能化物料管理：**
- 物料编码自动识别
- 规格型号详细记录
- 数量和单价实时计算
- 金额自动汇总
- 支持扫码添加（预留接口）

#### 🔍 物料选择功能
**便捷的物料选择：**
- 弹窗式物料选择器
- 显示物料编码、名称、规格
- 一键添加到出库明细
- 支持多物料批量添加

#### 💾 数据保存与验证
**严格的数据校验：**
- 必填字段验证
- 出库明细不能为空
- 数量和金额合理性检查
- 日期逻辑校验

## 🎨 界面设计特色

### 1. 驳回窗口设计
```
┌─────────────────────────────────┐
│ 驳回出库单                        │
├─────────────────────────────────┤
│ 出库单号：OUT202508060002        │
│ 仓库：码头1号仓库                 │
│ 领用部门：生产部                  │
├─────────────────────────────────┤
│ 驳回原因：[必填文本框]            │
│ [库存不足][信息错误][流程不符][其他] │
├─────────────────────────────────┤
│           [取消] [确认驳回]        │
└─────────────────────────────────┘
```

### 2. 出库修改页面布局
```
┌─────────────────────────────────┐
│ [返回] 修改出库单        [取消][保存] │
├─────────────────────────────────┤
│ 基本信息                         │
│ [出库单号] [仓库] [出库类型]       │
│ [出库日期] [发票日期] [设备编码]   │
├─────────────────────────────────┤
│ 领用信息                         │
│ [领用类型] [领用部门] [领用人]     │
│ [备注信息]                       │
├─────────────────────────────────┤
│ 出库明细              [扫码][添加] │
│ [物料列表表格]                   │
│ 合计：¥8,200.00                 │
└─────────────────────────────────┘
```

## 🔄 业务流程优化

### 1. 驳回流程
```
审核中状态 → 点击驳回 → 选择类别 → 输入原因 → 确认驳回 → 状态变更为"已驳回"
                                                    ↓
                                              通知申请人修改
```

### 2. 修改流程
```
出库中/审核中 → 点击修改 → 进入编辑页面 → 修改信息 → 保存 → 重新提交审核
```

### 3. 状态控制
**智能的操作权限控制：**
- **出库中** - 可修改、可审核、可驳回
- **审核中** - 可审核、可驳回、可修改
- **已审核** - 仅可查看详情
- **已驳回** - 可重新修改提交
- **已完成** - 仅可查看，不可修改

## 📱 用户体验优化

### 1. 交互体验
- **确认对话框** - 防止误操作
- **加载状态** - 操作过程中显示loading
- **成功提示** - 操作完成后给出明确反馈
- **错误处理** - 友好的错误提示信息

### 2. 数据验证
- **实时验证** - 输入时即时检查
- **表单验证** - 提交前完整性检查
- **业务规则** - 符合港口管理规范

### 3. 响应式设计
- **桌面端** - 完整功能展示
- **平板端** - 适配触摸操作
- **移动端** - 关键功能可用

## 🎯 港口管理特色

### 1. 业务场景适配
- **码头作业** - 装卸设备物资管理
- **船舶服务** - 船舶维修物资供应
- **港口维护** - 基础设施维护物资
- **安全管理** - 安全防护用品管理

### 2. 物资分类
- **机械设备** - 起重机、叉车配件
- **维修材料** - 钢丝绳、液压油、轴承
- **安全用品** - 安全帽、防护服、警示标识
- **办公用品** - 日常办公所需物资

### 3. 管理规范
- **三级审批** - 申请人→部门主管→仓库管理员
- **实名制** - 所有操作可追溯到具体人员
- **时效控制** - 紧急出库快速通道
- **成本控制** - 详细的成本核算

## 🚀 使用指南

### 1. 驳回出库单
```
出库管理列表 → 选择"审核中"状态单据 → 点击"驳回" → 选择类别 → 输入原因 → 确认
```

### 2. 修改出库单
```
出库管理列表 → 选择可修改状态单据 → 点击"修改" → 编辑信息 → 保存
```

### 3. 新建出库单
```
出库管理列表 → 点击"新建出库单" → 填写信息 → 添加明细 → 保存
```

## 📊 数据统计

### 模拟数据示例
```
出库单总数：156
待审核：23
已驳回：8
本月出库金额：¥450,200
平均处理时间：2.5小时
```

---

**功能状态：** ✅ 驳回和修改功能完整可用  
**适用场景：** 港口物资管理、码头作业支持  
**最后更新：** 2025年1月
